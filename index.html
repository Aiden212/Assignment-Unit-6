<!DOCTYPE html>
<html>

<head>
	<script type="text/javascript" src="https://getfirebug.com/firebug-lite-debug.js"></script>
	<meta name="description" content="CS4406 Computer Graphics - Assignment #5s" />
	<meta charset="utf-8" />
	<title>Assignment 5</title>

	</style>
	<meta charset=utf-8 />
	<title> CS4406 Computer Graphics - Programming Asignment U#5 </title>

	<style id="jsbin-css">
	</style>
</head>

<body>


	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.5/dat.gui.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/94/three.min.js"></script>
	<script src="https://cdn.rawgit.com/mrdoob/three.js/master/examples/js/controls/OrbitControls.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/6.2.1/math.min.js"></script>
	<script src="http://uopeopleweb.com/js/Detector.js"></script>
	<script type="text/javascript"></script>
	<script>



		// set the scene size
		var WIDTH = 700, HEIGHT = 700;

		// set some camera attributes
		var VIEW_ANGLE = 75, ASPECT = WIDTH / HEIGHT, NEAR = 1, FAR = 1000;

		// create a WebGL renderer, camera, and a scene
		var renderer = new THREE.WebGLRenderer();
		var scene = new THREE.Scene();
		var clock = new THREE.Clock();
		var camera = new THREE.PerspectiveCamera(VIEW_ANGLE, ASPECT, NEAR, FAR);

		// the camera starts at 0,0,0 so pull it back
		camera.position.z = 200;

		// add the camera to the scene
		scene.add(camera)
		// set up the camera controls.  Please keep in mind that what this does is move the entire scene around.
		// because the entire scene is moving the position of the camera and lights in relation to objects within 
		// the scene doesn't change so the lighting on the surface of the object(s) will not change either
		// var cameraControls = new OrbitControls(camera, renderer.domElement);
		// cameraControls.addEventListener('mousemove', renderer);

		// start the renderer
		renderer.setSize(WIDTH, HEIGHT);

		// attach the render-supplied DOM element
		document.body.appendChild(renderer.domElement);
		// ----------------------------------------------------------------------------------------
		//  END OF THE STANDARD CODE FOR THE ASSIGNMENT
		// ----------------------------------------------------------------------------------------

		//enable the shadow map
		renderer.shadowMapEnabled = true;

		renderer.shadowMapType = THREE.PCFSoftShadowMap;

		//Create spotlight for illumination; 

		var spotLight = new THREE.SpotLight(0xffffff);

		spotLight.position.set(120, 0, 80);

		spotLight.castShadow = true;

		// add to the scene 
		scene.add(spotLight);


		//Define the earth and moon objects
		//Create earth mesh using the geometry and material 
		var earthGeometry = new THREE.SphereGeometry(60, 128, 128);
		var textureEarthFlat = new
			THREE.TextureLoader().load("https://upload.wikimedia.org/wikipedia/commons/c/cf/WorldMap-A_non-Frame.png");
		var textureEarth = new
			THREE.TextureLoader().load("https://upload.wikimedia.org/wikipedia/commons/thumb/9/97/The_Earth_seen_from_Apollo_17.jpg/300px-The_Earth_seen_from_Apollo_17.jpg");
		var earthMaterial = new THREE.MeshPhongMaterial({
			map: textureEarthFlat, //earth texture
			shininess: 20
		});

		//Create earth mesh using the geometry and material 
		var earth = new THREE.Mesh(earthGeometry, earthMaterial);

		//add the earth mesh to the scene end enable it to receive and cast a shadow

		earth.receiveShadow = true;
		earth.castShadow = true;

		//Define the moon and moon objects, then create geometry and materials for the moon.
		var moonGeometry = new THREE.SphereGeometry(18, 128, 128);
		var textureMoonFlat = new
			THREE.TextureLoader().load("https://upload.wikimedia.org/wikipedia/commons/d/db/Moonmap_from_clementine_data.png");
		var textureMoon = new
			THREE.TextureLoader().load("https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/FullMoon2010.jpg/280px-FullMoon2010.jpg");
		var moonMaterial = new THREE.MeshPhongMaterial({
			map: textureMoonFlat, //moon texture
			shininess: 20
		});

		//Create moon mesh using the geometry and material we provide
		var moon = new THREE.Mesh(moonGeometry, moonMaterial);

		// set the moon in a position away from the earth
		moon.position.x = 100

		//add the moon mesh to the scene end enable it to receive and cast a shadow

		moon.receiveShadow = true;
		moon.castShadow = true;

		//set the orbit speed of the moon
		moonOrbitSpeed = .3;

		var theta = 1;
		var dTheta = moonOrbitSpeed * Math.PI / 100;


		// to set the orbit size of the moon
		var r = 100;

		var solarSystem = new THREE.Group();

		solarSystem.add(earth);

		solarSystem.add(moon);

		scene.add(solarSystem);

		//this ensures that the render is refreshed
		function animate() {
			requestAnimationFrame(animate);

			// Auto rotate the Earth and moon
			earth.rotation.y += 0.01
			moon.rotation.y -= 0.02

			//orbit rotation direction
			theta -= dTheta;



			//position the moon
			moon.position.x = r * Math.cos(theta);
			moon.position.z = r * Math.sin(theta);

			renderer.render(scene, camera);
		}

		animate();

		//optional controls

		// Event listeners to control the y-axis rotation of the earth and moon mouse clicks/arrow keys 
		function onDocumentMouseDown(event) {

			event.preventDefault();

			document.addEventListener('mousemove', onDocumentMouseMove);

			document.addEventListener('mouseup', onDocumentMouseUp);
		}

		function onDocumentMouseMove(event) {

			solarSystem.rotation.y += event.movementX * 0.01;

		}

		function onDocumentMouseUp() {

			document.removeEventListener('mousemove', onDocumentMouseMove);

			document.removeEventListener('mouseup', onDocumentMouseUp);
		}

		function onDocumentKeyDown(event) {

			switch (event.keyCode) {

				case 37: // Left arrow key
					solarSystem.rotation.y -= 0.1;
					break;

				case 39: // Right arrow key
					solarSystem.rotation.y += 0.1;
					break;

			}
		}

		document.addEventListener('mousedown', onDocumentMouseDown);

		document.addEventListener('keydown', onDocumentKeyDown);


		// ----------------------------------------------------------------------------------------
		// END OF YOUR CUSTOM CODE FOR THE ASSIGNMENT
		// The rendering functions that follow are standard and can be used for this assignment.
		// You are welcome to customize them or create your own if you desire, however, you can
		// simply use the code provided.


		// Standard functions for rendering the scene.  Notice how we have the animate function
		// which submits a call to requestAnimationFrame to call animate.   This creates a loop
		// that will render the scene again whenever something within the scene changes.



	</script>
</body>

</html>